System.register("chunks:///_virtual/HouseFactory.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ShadowDrawer.ts"],(function(e){"use strict";var t,o,r,n,s,a,i,u,c,h,f,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){s=e.cclegacy,a=e._decorator,i=e.EventTarget,u=e.Prefab,c=e.Component,h=e.instantiate},function(e){f=e.shadowDrawerEventTarget,p=e.ShadowDrawerEvent}],execute:function(){var l,d,_,y,g,v;s._RF.push({},"429c9Uamr1JUpO90LpIrSkF","HouseFactory",void 0);var H=a.ccclass,b=a.property,E=e("houseFactoryEventTarget",new i),m=e("HouseFactoryEvent",{REBUILD_HOUSES:"generateHouses"});e("HouseFactory",(l=H("HouseFactory"),d=b({type:[u]}),l((g=t((y=function(e){function t(){for(var t,o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t=e.call.apply(e,[this].concat(s))||this,r(t,"prefabs",g,n(t)),r(t,"houseCount",v,n(t)),t._houses=[],t}o(t,e);var s=t.prototype;return s.onLoad=function(){this._generateHouses(),E.on(m.REBUILD_HOUSES,this.onRebuildHouses,this)},s._getRandomPlace=function(e){return Math.floor(Math.random()*e-e/2)},s._generateHouses=function(){var e=this;this.node.children.forEach((function(e){return e.destroy()})),this._houses=[];for(var t=2*Math.ceil(Math.sqrt(this.houseCount)),o=0,r=function(){var r=e._getRandomPlace(t),n=e._getRandomPlace(t),s=void 0!==e._houses.find((function(e){return e.x===r&&e.y===n}));if(0!==r&&0!==n&&!s){var a=e.prefabs[Math.floor(Math.random()*e.prefabs.length)];e._houses.push({node:h(a),x:r,y:n,posX:80*(r-n),posY:-40*(r+n)}),o++}};o<this.houseCount;)r();this._houses.sort((function(e,t){return t.posY-e.posY})),this._houses.forEach((function(t){t.node.setPosition(t.posX,t.posY),t.node.setParent(e.node)})),f.emit(p.REDRAW_SHADOW)},s.onRebuildHouses=function(){f.emit(p.CLEAR_SHADOW_OBJECTS),this._generateHouses()},t}(c)).prototype,"prefabs",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=t(y.prototype,"houseCount",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 25}}),_=y))||_));s._RF.pop()}}}));

System.register("chunks:///_virtual/InputHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ShadowDrawer.ts"],(function(t){"use strict";var n,o,e,r,a,s,h,i,u,c;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,r=t.UITransform,a=t.input,s=t.Input,h=t.v2,i=t.Component},function(t){u=t.shadowDrawerEventTarget,c=t.ShadowDrawerEvent}],execute:function(){var l;o._RF.push({},"586dfw+E1ZHwrsfKP5k2G3o","InputHandler",void 0);var p=e.ccclass;e.property,t("InputHandler",p("InputHandler")(l=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),r=0;r<o;r++)e[r]=arguments[r];return(n=t.call.apply(t,[this].concat(e))||this)._shadowLength=30,n._shadowAngle=0,n._transform=null,n}n(o,t);var e=o.prototype;return e.start=function(){this._transform=this.getComponent(r),a.on(s.EventType.MOUSE_MOVE,this.onMouseMove,this)},e.onMouseMove=function(t){var n=this._transform.contentSize,o=t.getLocation(),e=h(o.x-n.width/2,o.y-n.height/2),r=Math.hypot(e.x,e.y)/7,a=180+Math.floor(180*Math.atan2(e.y,e.x)/Math.PI);a===this._shadowAngle&&a===this._shadowAngle||(this._shadowLength=r,this._shadowAngle=a,u.emit(c.REDRAW_SHADOW,this._shadowAngle,this._shadowLength))},o}(i))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./HouseFactory.ts","./InputHandler.ts","./RebuildButton.ts","./ShadowCamera.ts","./ShadowDrawer.ts","./ShadowOwner.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/RebuildButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HouseFactory.ts"],(function(t){"use strict";var o,e,n,u,r,c,i;return{setters:[function(t){o=t.inheritsLoose},function(t){e=t.cclegacy,n=t._decorator,u=t.Node,r=t.Component},function(t){c=t.houseFactoryEventTarget,i=t.HouseFactoryEvent}],execute:function(){var s;e._RF.push({},"54a090Qd61H8JOWIFJWUmvv","RebuildButton",void 0);var a=n.ccclass;n.property,t("RebuildButton",a("RebuildButton")(s=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.start=function(){this.node.on(u.EventType.TOUCH_START,this.onTouchStart,this)},n.onTouchStart=function(){c.emit(i.REBUILD_HOUSES)},e}(r))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/ShadowCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,i,o,r,n,s,a,h,c;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.EventTarget,n=t.view,s=t.Rect,a=t.size,h=t.UITransform,c=t.Camera}],execute:function(){var d;i._RF.push({},"e35e3AdLfZLFZ2hWcXsEN39","ShadowCamera",void 0);var u=o.ccclass,l=(o.property,t("shadowCameraEventTarget",new r)),f=t("ShadowCameraEvent",{STICK_NODE_TO_CAMERA:"stickNodeToCamera"});t("ShadowCamera",u("ShadowCamera")(d=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))||this)._transform=null,e}e(i,t);var o=i.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this),this.enabled&&(this.targetTexture?(n.on("canvas-resize",this.onCanvasResize,this),l.on(f.STICK_NODE_TO_CAMERA,this.onStickNodeToCamera,this)):this.enabled=!1)},o.start=function(){this.onCanvasResize()},o.getVisibleRect=function(){var t=n.getVisibleSize(),e=t.width/t.height,i=this.node.worldPosition,o=2*this.orthoHeight,r=e*o;return new s(i.x-.5*r,i.y-.5*o,r,o)},o.onCanvasResize=function(){var t=this.getVisibleRect();if(this.targetTexture.resize(t.width,t.height),this._transform){var e=a(t.width,t.height);this._transform.setContentSize(e)}},o.onStickNodeToCamera=function(t,e){this._transform=t.getComponent(h),this._transform.setContentSize(this.camera.width,this.camera.height),this.orthoHeight=this._transform.height/2;var i=this.node.getWorldPosition(),o=t.getWorldPosition();this.node.setWorldPosition(o.x,o.y,i.z),this.targetTexture.resize(this._transform.width,this._transform.height),e instanceof Function&&e(this.targetTexture)},i}(c))||d);i._RF.pop()}}}));

System.register("chunks:///_virtual/ShadowDrawer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ShadowCamera.ts"],(function(e){"use strict";var t,i,r,o,n,a,s,l,h,c,u,d,f,p,w,_,E,S,b,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.initializerDefineProperty,r=e.inheritsLoose,o=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,s=e.EventTarget,l=e.EffectAsset,h=e.Graphics,c=e.Node,u=e.Layers,d=e.Sprite,f=e.SpriteFrame,p=e.v2,w=e.Intersection2D,_=e.Material,E=e.Component,S=e.Color},function(e){b=e.shadowCameraEventTarget,v=e.ShadowCameraEvent}],execute:function(){var y,g,k,m,G,D,R,C,T,x,A,O,B,z,M,L,W,P;n._RF.push({},"58a7babm2FIDZ4A1D9o+Bkv","ShadowDrawer",void 0);var I=a.ccclass,N=a.property,j=e("shadowDrawerEventTarget",new s),H=e("ShadowDrawerEvent",{REGISTER_SHADOW_OBJECT:"registerShadowObject",REDRAW_SHADOW:"redrawShadow",CLEAR_SHADOW_OBJECTS:"clearShadowObjects"}),F=I("ShadowRender")((k=t((g=function(e,t){i(this,"owner",k,this),i(this,"points",m,this),i(this,"scale",G,this),this.owner=e,this.points=t,this.scale=e.shadowScale}).prototype,"owner",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=t(g.prototype,"points",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),G=t(g.prototype,"scale",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),y=g))||y;e("ShadowDrawer",(D=I("ShadowDrawer"),R=N({type:l}),C=N({type:l}),T=N({type:l}),D((O=t((A=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t=e.call.apply(e,[this].concat(n))||this,i(t,"shadowColor",O,o(t)),i(t,"shadowAngle",B,o(t)),i(t,"shadowLength",z,o(t)),i(t,"shadowBlurWidth",M,o(t)),i(t,"fillEffect",L,o(t)),i(t,"strokeEffect",W,o(t)),i(t,"renderEffect",P,o(t)),t._shadowRenders=[],t._fillGraphics=null,t._strokeGraphics=null,t}r(t,e);var n=t.prototype;return n.onLoad=function(){this._fillGraphics=this._createGraphics("FillNode",this.fillEffect),this._strokeGraphics=this._createGraphics("StrokeNode",this.strokeEffect),this._strokeGraphics.lineWidth=this.shadowBlurWidth,this._strokeGraphics.lineJoin=h.LineJoin.ROUND,j.on(H.REGISTER_SHADOW_OBJECT,this.onRegisterShadowObject,this),j.on(H.REDRAW_SHADOW,this.onRedrawShadow,this),j.on(H.CLEAR_SHADOW_OBJECTS,this.onClearShadowObjects,this)},n.start=function(){this._createRenderNode(),this._drawShadow()},n._createGraphics=function(e,t){var i=new c(e),r=i.addComponent(h);return r.strokeColor=this.shadowColor,r.fillColor=this.shadowColor,i.layer=u.Enum.shadow,i.setParent(this.node),this._setShadowMaterial(r,t),r},n._createRenderNode=function(){var e=this,t=new c("RenderNode");t.layer=u.Enum.UI_2D,t.setParent(this.node);var i=t.addComponent(d);b.emit(v.STICK_NODE_TO_CAMERA,t,(function(t){var r=new f;r.texture=t,i.spriteFrame=r,e._setShadowMaterial(i,e.renderEffect)}))},n._drawShadow=function(){var e=this,t=this.shadowAngle*(Math.PI/180);this._fillGraphics.clear(),this._strokeGraphics.clear(),this._shadowRenders.forEach((function(i){var r=p(Math.cos(t)*e.shadowLength*i.scale,Math.sin(t)*e.shadowLength/2*i.scale),o=[],n=i.points.map((function(e,t,i){o.push({position:e.clone(),isBase:!0,isExternal:!0,isDrawn:!1}),o.push({position:e.clone().add(r),isBase:!1,isExternal:!0,isDrawn:!1,link:o[2*t]}),o[2*t].link=o[2*t+1];var n=i[(t+1)%i.length];return[e.clone(),n.clone(),n.clone().add(r),e.clone().add(r)]})),a=o.filter((function(e){return e.isBase})),s=o.filter((function(e){return!e.isBase}));if(n.push(a.map((function(e){return e.position}))),n.push(s.map((function(e){return e.position}))),n.forEach((function(t){o.filter((function(e){return void 0===t.find((function(t){return t.equals(e.position)}))})).forEach((function(e){w.pointInPolygon(e.position,t)&&(e.isExternal=!1)})),t.forEach((function(t,i){var r=0===i?"moveTo":"lineTo";e._fillGraphics[r](t.x,t.y)})),e._fillGraphics.fill()})),a.filter((function(e){return e.isExternal})).length===s.filter((function(e){return e.isExternal})).length){var l=o.filter((function(e){return e.isExternal})).length,h=a.find((function(e){return e.isExternal}));e._strokeGraphics.moveTo(h.position.x,h.position.y),h.isDrawn=!0;for(var c=h.position,u=1;u<l;){var d=h.isBase,f=d?a.indexOf(h):s.indexOf(h),_=d?a.length:s.length,E=d?a[(f+1)%_]:s[(f+1)%_];h=E.isExternal&&!E.isDrawn?E:h.link,e._strokeGraphics.lineTo(h.position.x,h.position.y),h.isDrawn=!0,u++}e._strokeGraphics.lineTo(c.x,c.y),e._strokeGraphics.stroke()}else a.forEach((function(t,i){var r=0===i?"moveTo":"lineTo";e._strokeGraphics[r](t.position.x,t.position.y)})),e._strokeGraphics.lineTo(a[0].position.x,a[0].position.y),e._strokeGraphics.stroke(),s.forEach((function(t,i){var r=0===i?"moveTo":"lineTo";e._strokeGraphics[r](t.position.x,t.position.y)})),e._strokeGraphics.lineTo(s[0].position.x,s[0].position.y),e._strokeGraphics.stroke(),a.forEach((function(t,i){e._strokeGraphics.moveTo(t.position.x,t.position.y),e._strokeGraphics.lineTo(t.link.position.x,t.link.position.y),e._strokeGraphics.stroke()}))}))},n._setShadowMaterial=function(e,t){if(e&&t){var i=new _;i.initialize({effectAsset:t,defines:{USE_RGBE_CUBEMAP:!0}}),e.setMaterial(i,0),void 0!==e.sharedMaterial.getProperty("shadowColor")&&e.sharedMaterial.setProperty("shadowColor",this.shadowColor),e.updateRenderer()}},n.onRegisterShadowObject=function(e,t){var i=this,r=t.map((function(e){return e.subtract(p(i.node.worldPosition.x,i.node.worldPosition.y))}));this._shadowRenders.push(new F(e,r))},n.onRedrawShadow=function(e,t){void 0!==e&&(this.shadowAngle=e),void 0!==t&&(this.shadowLength=t),this._drawShadow()},n.onClearShadowObjects=function(){this._shadowRenders=[],this._drawShadow()},t}(E)).prototype,"shadowColor",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new S(0,0,0)}}),B=t(A.prototype,"shadowAngle",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=t(A.prototype,"shadowLength",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),M=t(A.prototype,"shadowBlurWidth",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),L=t(A.prototype,"fillEffect",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(A.prototype,"strokeEffect",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(A.prototype,"renderEffect",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=A))||x));n._RF.pop()}}}));

System.register("chunks:///_virtual/ShadowOwner.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ShadowDrawer.ts"],(function(e){"use strict";var o,t,r,i,n,a,l,s,c,d,h;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,l=e.PolygonCollider2D,s=e.v2,c=e.Component},function(e){d=e.shadowDrawerEventTarget,h=e.ShadowDrawerEvent}],execute:function(){var u,p,w;n._RF.push({},"2022dIqRIZE1K8gyVBRRitM","ShadowOwner",void 0);var y=a.ccclass,f=a.property,_=a.requireComponent;e("ShadowOwner",y("ShadowOwner")(u=_(l)((w=o((p=function(e){function o(){for(var o,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return o=e.call.apply(e,[this].concat(n))||this,r(o,"shadowScale",w,i(o)),o._collider=null,o}return t(o,e),o.prototype.onLoad=function(){var e=this;if(this._collider=this.getComponent(l),this._collider){this._collider.sensor=!0,this._collider.apply();var o=s(this.node.worldPosition.x,this.node.worldPosition.y),t=this._collider.offset,r=s(t.x*this.node.scale.x,t.y*this.node.scale.y),i=this._collider.points.map((function(t){var i=s(t.x*e.node.scale.x,t.y*e.node.scale.y);return o.clone().add(i).add(r)}));d.emit(h.REGISTER_SHADOW_OBJECT,this,i)}},o}(c)).prototype,"shadowScale",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),u=p))||u)||u);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});