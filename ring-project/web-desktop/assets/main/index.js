window.__require=function e(t,o,r){function n(c,l){if(!o[c]){if(!t[c]){var a=c.split("/");if(a=a[a.length-1],!t[a]){var s="function"==typeof __require&&__require;if(!l&&s)return s(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var u=o[c]={exports:{}};t[c][0].call(u.exports,function(e){return n(t[c][1][e]||e)},u,u.exports,e,t,o,r)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<r.length;c++)n(r[c]);return n}({AngleUtil:[function(e,t,o){"use strict";cc._RF.push(t,"befa6u6nmFHS7S+oyE3RjMz","AngleUtil"),Object.defineProperty(o,"__esModule",{value:!0}),o.AngleUtil=void 0;var r=function(){function e(){}return e.getRadAngle=function(e,t){return Math.atan2(e.y-t.y,e.x-t.x)},e.getDegreeAngle=function(e,t){var o=this.getRadAngle(e,t);return this.radToDegree(o)},e.getDeltaAngle=function(e,t,o){var r=Math.atan2(e.y-t.y,e.x-t.x),n=Math.atan2(e.y-o.y,e.x-o.x);return this.radToDegree(r)-this.radToDegree(n)},e.radToDegree=function(e){return 180*e/Math.PI+180},e.degreeToRad=function(e){return(e-180)*Math.PI/180},e.validateAngle=function(e){return(e+360)%360},e.isInRange=function(e,t){return t.minAngle<=e&&t.maxAngle>=e},e}();o.AngleUtil=r,cc._RF.pop()},{}],BaseAnimator:[function(e,t,o){"use strict";cc._RF.push(t,"7ca95VRUY1G7q6Lu/A7SeIz","BaseAnimator");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.BaseAnimator=void 0;var c=cc._decorator,l=c.ccclass,a=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._duration=.5,t._delay=.25,t}return n(t,e),i([a({visible:!0})],t.prototype,"_duration",void 0),i([a({visible:!0})],t.prototype,"_delay",void 0),i([l],t)}(cc.Component);o.BaseAnimator=s,cc._RF.pop()},{}],BaseCollisionHandler:[function(e,t,o){"use strict";cc._RF.push(t,"b3023lNw8tIu6D40sy7L+bx","BaseCollisionHandler");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.BaseCollisionHandler=void 0;var c=cc._decorator,l=c.ccclass,a=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lockGroups=["lock"],t}return n(t,e),t.prototype.onCollisionEnter=function(e,t){this._lockGroups.includes(e.node.group)&&this._addCollision(e,t)},t.prototype.onCollisionStay=function(e,t){this._lockGroups.includes(e.node.group)&&this._stayCollision(e,t)},t.prototype.onCollisionExit=function(e,t){this._lockGroups.includes(e.node.group)&&this._removeCollision(e,t)},i([a({type:[cc.String],visible:!0})],t.prototype,"_lockGroups",void 0),i([l],t)}(cc.Component);o.BaseCollisionHandler=s,cc._RF.pop()},{}],BaseModel:[function(e,t,o){"use strict";cc._RF.push(t,"5fc341rCQhGLbDfjm0BMYQd","BaseModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.BaseModel=void 0;var r=function(){function e(e){e&&this.initData(e)}return e.prototype.updateData=function(e){var t=Object.assign({},this.getData(),e);this.initData(t)},e}();o.BaseModel=r,cc._RF.pop()},{}],BaseView:[function(e,t,o){"use strict";cc._RF.push(t,"7c151LVAZpPN4LerAu1561+","BaseView");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.BaseView=void 0;var c=cc._decorator,l=c.ccclass,a=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderSprite=null,t}return n(t,e),Object.defineProperty(t.prototype,"angle",{get:function(){return this.node.angle},set:function(e){this.node.angle=e},enumerable:!1,configurable:!0}),t.prototype.render=function(e){this.node.setPosition(e.x,e.y),this.node.angle=e.angle},t.prototype.changeSpriteFrame=function(e){this._renderSprite&&(this._renderSprite.spriteFrame=e)},i([a({type:cc.Sprite,visible:!0})],t.prototype,"_renderSprite",void 0),i([a],t.prototype,"angle",null),i([l],t)}(cc.Component);o.BaseView=s,cc._RF.pop()},{}],BlockAnimator:[function(e,t,o){"use strict";cc._RF.push(t,"e665fwLwflFSJg9eqN8dZCJ","BlockAnimator");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.BlockAnimator=void 0;var c=e("./BaseAnimator"),l=cc._decorator,a=l.ccclass,s=l.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lastAngle=0,t._cycleCount=5,t._amplitude=3,t}return n(t,e),t.prototype.animate=function(){this._tween&&(this._tween.stop(),this.node.angle=this._lastAngle),this._lastAngle=this.node.angle,this._tween=cc.tween(this.node).delay(this._delay);for(var e=0;e<this._cycleCount-1;e++)this._tween.to(this._duration/this._cycleCount,{angle:this.node.angle-this._amplitude*(e%2?1:-1)});this._tween.to(this._duration/this._cycleCount,{angle:this.node.angle}).start()},i([s({visible:!0})],t.prototype,"_cycleCount",void 0),i([s({visible:!0})],t.prototype,"_amplitude",void 0),i([a],t)}(c.BaseAnimator);o.BlockAnimator=u,cc._RF.pop()},{"./BaseAnimator":"BaseAnimator"}],BlockerPieceBuilder:[function(e,t,o){"use strict";cc._RF.push(t,"fe712tuj5dMLadxZp9PPwxQ","BlockerPieceBuilder");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BlockerPieceBuilder=void 0;var l=e("../model/LockModel"),a=e("../view/LockView"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._getPieceData=function(e,t){return i(this,void 0,Promise,function(){var o,r;return c(this,function(n){switch(n.label){case 0:return o=this._getView(e),r=this._getModel(t),this._fieldModel.addPiece(o,r),[4,this._updateSpriteFrame(o,t.configEntry.color)];case 1:return n.sent(),this._bindHandlers(o),[2,{node:e,view:o,model:r}]}})})},t.prototype._getView=function(e){return e.getComponent(a.LockView)},t.prototype._getModel=function(e){return new l.LockModel(e.configEntry)},t}(e("./PieceBuilder").PieceBuilder);o.BlockerPieceBuilder=s,cc._RF.pop()},{"../model/LockModel":"LockModel","../view/LockView":"LockView","./PieceBuilder":"PieceBuilder"}],BundleLoader:[function(e,t,o){"use strict";cc._RF.push(t,"a9c077G1pVDuppkzqENWVGQ","BundleLoader");var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BundleLoader=void 0;var i=function(){function e(e){var t=e.cacheManager,o=e.bundleConfig;this._cacheManager=t,this._bundleConfig=o,this._wholeProgress=Object.values(this._bundleConfig).reduce(function(e,t){return e+t.files.length},0)}return e.prototype.load=function(e){return r(this,void 0,void 0,function(){var t,o,r,i,c,l,a;return n(this,function(n){switch(n.label){case 0:this._progressCallback=e,this._progress=0,t=0,o=Object.entries(this._bundleConfig),n.label=1;case 1:return t<o.length?(r=o[t],i=r[0],c=r[1],l=c.type,a=c.files,[4,this._loadBundle(i,l,a)]):[3,4];case 2:n.sent(),console.log(i,"loaded!"),n.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},e.prototype._loadBundle=function(e,t,o){return r(this,void 0,void 0,function(){var i=this;return n(this,function(){return[2,new Promise(function(c,l){cc.assetManager.loadBundle(e,function(e,a){return r(i,void 0,void 0,function(){var r,i,s;return n(this,function(n){switch(n.label){case 0:if(e)return[3,5];r=0,i=o,n.label=1;case 1:return r<i.length?(s=i[r],[4,this._loadFile(a,t,s)]):[3,4];case 2:n.sent(),n.label=3;case 3:return r++,[3,1];case 4:return c(a),[3,6];case 5:l(e),n.label=6;case 6:return[2]}})})})})]})})},e.prototype._loadFile=function(e,t,o){return r(this,void 0,void 0,function(){var r=this;return n(this,function(){return[2,new Promise(function(n,i){e.load(o,t,null,function(t,c){var l,a=++r._progress/r._wholeProgress;r._progressCallback(a),t?i(t):(null===(l=r._cacheManager)||void 0===l||l.add(e.name+"/"+o,c),n(c))})})]})})},e}();o.BundleLoader=i,cc._RF.pop()},{}],BundlePrefabGetter:[function(e,t,o){"use strict";cc._RF.push(t,"e287eARv8JDQYXyxWh42VI6","BundlePrefabGetter");var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BundlePrefabGetter=void 0;var i=function(){function e(e){var t=e.bundleName,o=e.cacheManager;this._bundleName=t,this._cacheManager=o}return e.prototype.get=function(e){return r(this,void 0,Promise,function(){var t=this;return n(this,function(){return[2,new Promise(function(o,r){var n,i=null===(n=t._cacheManager)||void 0===n?void 0:n.get(t._bundleName+"/"+e);i&&o(i),cc.assetManager.getBundle(t._bundleName).load(e,cc.Prefab,null,function(e,t){e&&r(e),o(t)})})]})})},e}();o.BundlePrefabGetter=i,cc._RF.pop()},{}],CacheManager:[function(e,t,o){"use strict";cc._RF.push(t,"6bc7dsZ6btJkq4X6+QiP5Vc","CacheManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.CacheManager=void 0;var r=function(){function e(){this._entries={}}return e.prototype.add=function(e,t){this._entries[e]=t},e.prototype.get=function(e){return this._entries[e]},e}();o.CacheManager=r,cc._RF.pop()},{}],CameraAdapter:[function(e,t,o){"use strict";cc._RF.push(t,"b53146McI9CSrWYZzPzBkzf","CameraAdapter");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.CameraAdapter=void 0;var c=cc._decorator,l=c.ccclass,a=c.property,s=function(){function e(){this.sizeRatio=0,this.portraitZoom=0,this.landscapeZoom=0}return i([a({})],e.prototype,"sizeRatio",void 0),i([a({})],e.prototype,"portraitZoom",void 0),i([a({})],e.prototype,"landscapeZoom",void 0),i([l("ZoomResizeMap")],e)}(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.settings=[],t.cameras=[],t}return n(t,e),t.prototype.onLoad=function(){this._handleResizeEvents(!0),this.onTransformEvent();var e=this.getComponent(cc.Camera);0===this.cameras.length&&e&&(this.cameras=[e])},t.prototype._handleResizeEvents=function(e){var t=e?"on":"off";cc.view[t]("design-resolution-changed",this.onTransformEvent,this),cc.view[t]("canvas-resize",this.onTransformEvent,this),cc.director[t](cc.Director.EVENT_AFTER_SCENE_LAUNCH,this.onTransformEvent,this)},t.prototype._getTargetMap=function(e){return this.settings.sort(function(e,t){return t.sizeRatio-e.sizeRatio}).find(function(t){return t.sizeRatio<e})},t.prototype.onTransformEvent=function(){var e=cc.view.getVisibleSize(),t=e.width>e.height,o=Math.max(e.width/e.height,e.height/e.width),r=this._getTargetMap(o);r&&this.cameras.forEach(function(e){e.zoomRatio=r[t?"landscapeZoom":"portraitZoom"]})},i([a({type:[s]})],t.prototype,"settings",void 0),i([a({type:[cc.Camera]})],t.prototype,"cameras",void 0),i([l],t)}(cc.Component);o.CameraAdapter=u,cc._RF.pop()},{}],ColorSpriteFrameGetter:[function(e,t,o){"use strict";cc._RF.push(t,"1639cGlPrJB+LAovuMnpZAS","ColorSpriteFrameGetter");var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.ColorSpriteFrameGetter=void 0;var i=function(){function e(e){var t=e.bundleName,o=e.spriteNamePrefix,r=e.cacheManager;this._bundleName=t,this._spriteNamePrefix=o,this._cacheManager=r}return e.prototype.get=function(e){return r(this,void 0,Promise,function(){var t=this;return n(this,function(){return[2,new Promise(function(o,r){var n,i=null===(n=t._cacheManager)||void 0===n?void 0:n.get(t._bundleName+"/"+t._spriteNamePrefix+e);i&&o(i),cc.assetManager.getBundle(t._bundleName).load(""+t._spriteNamePrefix+e,cc.SpriteFrame,null,function(e,t){e&&r(e),o(t)})})]})})},e}();o.ColorSpriteFrameGetter=i,cc._RF.pop()},{}],ColorType:[function(e,t,o){"use strict";cc._RF.push(t,"abd6f3WO4JFTpzDLlBPftvf","ColorType"),Object.defineProperty(o,"__esModule",{value:!0}),o.ColorType=void 0,function(e){e.Red="red",e.Green="green",e.Blue="blue",e.Yellow="yellow",e.Pink="pink"}(o.ColorType||(o.ColorType={})),cc._RF.pop()},{}],CommonInjectorConfig:[function(e,t,o){"use strict";cc._RF.push(t,"bca7793B65IeJDNeARNaG3R","CommonInjectorConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.CacheResolver=void 0;var r=e("../../builder/BlockerPieceBuilder"),n=e("../../controller/LockablePieceController"),i=e("../../controller/LockController"),c=e("../../controller/RingController"),l=e("../../controller/TutorialController"),a=e("../../getter/BundlePrefabGetter"),s=e("../../getter/ColorSpriteFrameGetter"),u=e("../../managers/CacheManager"),p=e("./ModelInjectorConfig");o.CacheResolver=new u.CacheManager,o.default={BlockerPieceBuilder:new r.BlockerPieceBuilder({prefabGetter:new a.BundlePrefabGetter({bundleName:"prefabs",cacheManager:o.CacheResolver}),spriteFrameGetter:new s.ColorSpriteFrameGetter({bundleName:"images",spriteNamePrefix:"single_blocker_",cacheManager:o.CacheResolver}),fieldModel:p.default.FieldModel,prefabName:"LockView",handlers:{collisionHandler:new i.LockController({fieldModel:p.default.FieldModel,lockablePieceController:new n.LockablePieceController({fieldModel:p.default.FieldModel})})}}),RingController:new c.RingController({fieldModel:p.default.FieldModel,tutorialController:new l.TutorialController({tutorNodePath:"Canvas/Tutorial",fieldModel:p.default.FieldModel})}),LockablePieceController:new n.LockablePieceController({fieldModel:p.default.FieldModel}),TutorialController:new l.TutorialController({tutorNodePath:"Canvas/Tutorial",fieldModel:p.default.FieldModel}),CacheManager:o.CacheResolver},cc._RF.pop()},{"../../builder/BlockerPieceBuilder":"BlockerPieceBuilder","../../controller/LockController":"LockController","../../controller/LockablePieceController":"LockablePieceController","../../controller/RingController":"RingController","../../controller/TutorialController":"TutorialController","../../getter/BundlePrefabGetter":"BundlePrefabGetter","../../getter/ColorSpriteFrameGetter":"ColorSpriteFrameGetter","../../managers/CacheManager":"CacheManager","./ModelInjectorConfig":"ModelInjectorConfig"}],Config:[function(e,t,o){"use strict";cc._RF.push(t,"d1b5fod00hPCaodDHmbs9tc","Config"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],1:[function(e,t,o){(function(e){function t(e,t){for(var o=0,r=e.length-1;r>=0;r--){var n=e[r];"."===n?e.splice(r,1):".."===n?(e.splice(r,1),o++):o&&(e.splice(r,1),o--)}if(t)for(;o--;o)e.unshift("..");return e}function r(e){"string"!=typeof e&&(e+="");var t,o=0,r=-1,n=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!n){o=t+1;break}}else-1===r&&(n=!1,r=t+1);return-1===r?"":e.slice(o,r)}function n(e,t){if(e.filter)return e.filter(t);for(var o=[],r=0;r<e.length;r++)t(e[r],r,e)&&o.push(e[r]);return o}o.resolve=function(){for(var o="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var c=i>=0?arguments[i]:e.cwd();if("string"!=typeof c)throw new TypeError("Arguments to path.resolve must be strings");c&&(o=c+"/"+o,r="/"===c.charAt(0))}return(r?"/":"")+(o=t(n(o.split("/"),function(e){return!!e}),!r).join("/"))||"."},o.normalize=function(e){var r=o.isAbsolute(e),c="/"===i(e,-1);return(e=t(n(e.split("/"),function(e){return!!e}),!r).join("/"))||r||(e="."),e&&c&&(e+="/"),(r?"/":"")+e},o.isAbsolute=function(e){return"/"===e.charAt(0)},o.join=function(){var e=Array.prototype.slice.call(arguments,0);return o.normalize(n(e,function(e){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},o.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var o=e.length-1;o>=0&&""===e[o];o--);return t>o?[]:e.slice(t,o-t+1)}e=o.resolve(e).substr(1),t=o.resolve(t).substr(1);for(var n=r(e.split("/")),i=r(t.split("/")),c=Math.min(n.length,i.length),l=c,a=0;a<c;a++)if(n[a]!==i[a]){l=a;break}var s=[];for(a=l;a<n.length;a++)s.push("..");return(s=s.concat(i.slice(l))).join("/")},o.sep="/",o.delimiter=":",o.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),o=47===t,r=-1,n=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!n){r=i;break}}else n=!1;return-1===r?o?"/":".":o&&1===r?"/":e.slice(0,r)},o.basename=function(e,t){var o=r(e);return t&&o.substr(-1*t.length)===t&&(o=o.substr(0,o.length-t.length)),o},o.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,o=0,r=-1,n=!0,i=0,c=e.length-1;c>=0;--c){var l=e.charCodeAt(c);if(47!==l)-1===r&&(n=!1,r=c+1),46===l?-1===t?t=c:1!==i&&(i=1):-1!==t&&(i=-1);else if(!n){o=c+1;break}}return-1===t||-1===r||0===i||1===i&&t===r-1&&t===o+1?"":e.slice(t,r)};var i="b"==="ab".substr(-1)?function(e,t,o){return e.substr(t,o)}:function(e,t,o){return t<0&&(t=e.length+t),e.substr(t,o)}}).call(this,e("_process"))},{_process:2}],2:[function(e,t){var o,r,n=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function l(e){if(o===setTimeout)return setTimeout(e,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}function a(e){if(r===clearTimeout)return clearTimeout(e);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(e){r=c}})();var s,u=[],p=!1,f=-1;function d(){p&&s&&(p=!1,s.length?u=s.concat(u):f=-1,u.length&&h())}function h(){if(!p){var e=l(d);p=!0;for(var t=u.length;t;){for(s=u,u=[];++f<t;)s&&s[f].run();f=-1,t=u.length}s=null,p=!1,a(e)}}function y(e,t){this.fun=e,this.array=t}function _(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];u.push(new y(e,t)),1!==u.length||p||l(h)},y.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=_,n.addListener=_,n.once=_,n.off=_,n.removeListener=_,n.removeAllListeners=_,n.emit=_,n.prependListener=_,n.prependOnceListener=_,n.listeners=function(){return[]},n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],DataExporter:[function(e,t,o){"use strict";cc._RF.push(t,"a52fdwkFVRHDbH3njcV95Uw","DataExporter"),o.__esModule=!0,o.saveExportJson=function(t,o,r,n){if(void 0===r&&(r="assets/data"),void 0===n&&(n=!1),t&&o){var i=e("fs"),c=e("path"),l=c.join(Editor.Project.path,r);if(i.existsSync(l)||i.mkdirSync(l),!n)for(var a=0;i.existsSync(c.join(l,o+".json"));)o=o+"_"+ ++a;i.writeFileSync(c.join(l,o+".json"),JSON.stringify(t,null,2)),Editor.assetdb.refresh("db://"+r),cc.log("Done! File '"+o+".json' was saved to '"+r+"' folder.")}},cc._RF.pop()},{fs:void 0,path:1}],DestroyAnimator:[function(e,t,o){"use strict";cc._RF.push(t,"389c5yFRfhHUZUY8mj2Af19","DestroyAnimator");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.DestroyAnimator=void 0;var c=e("./BaseAnimator"),l=cc._decorator.ccclass,a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.animate=function(){var e,t=this;null===(e=this._tween)||void 0===e||e.stop(),this._tween=cc.tween(this.node).delay(this._delay).to(this._duration,{y:this.node.y-200,opacity:0},{easing:cc.easing.backIn}).call(function(){t.node.destroy()}).start()},i([l],t)}(c.BaseAnimator);o.DestroyAnimator=a,cc._RF.pop()},{"./BaseAnimator":"BaseAnimator"}],EnumUtil:[function(e,t,o){"use strict";cc._RF.push(t,"d7bb9FrY25Av5duLDd+vE5M","EnumUtil"),Object.defineProperty(o,"__esModule",{value:!0}),o.EnumUtil=void 0;var r=function(){function e(){}return e.getCCEnum=function(e,t){return cc.Enum(Object.values(e).reduce(function(e,o,r){return t&&t.includes(o)||(e[o]=r),e},{}))},e.getCCEnumElement=function(e,t){return Object.values(e)[t]},e.getCCEnumIndex=function(e,t){return Object.values(e).indexOf(t)},e}();o.EnumUtil=r,cc._RF.pop()},{}],FieldBuilderComponent:[function(e,t,o){"use strict";cc._RF.push(t,"8ab34ScxbBPp63uGWxR5oYG","FieldBuilderComponent");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.FieldBuilderComponent=void 0;var a=e("../scripts/enum/PieceType"),s=e("./FieldPiece"),u=e("../scripts/factory/PieceFactory"),p=e("../scripts/model/FieldModel"),f=e("../scripts/builder/RingPieceBuilder"),d=e("../scripts/builder/LockablePieceBuilder"),h=e("../scripts/builder/BlockerPieceBuilder"),y=e("./SpriteFrameGetterComponent"),_=e("./PrefabGetterComponent"),b=e("./DataExporter"),v=cc._decorator,g=v.ccclass,P=v.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._pieces=[],t._fieldData=[],t._model=null,t._exportField=!1,t._pieceFactory=null,t._prefabGetter=null,t._ringSpriteFrameGetter=null,t._lockSpriteFrameGetter=null,t.exportName="field",t}return n(t,e),Object.defineProperty(t.prototype,"pieces",{get:function(){return this._pieces},set:function(e){this._pieces=e,this._buildField()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exportField",{get:function(){return!1},set:function(){b.saveExportJson(this._fieldData,this.exportName,"assets/fieldBuilder/configs")},enumerable:!1,configurable:!0}),t.prototype._configureBuilder=function(){var e;if(this._fieldData=[],this._model=new p.FieldModel,!this._pieceFactory){var t=new h.BlockerPieceBuilder({prefabGetter:this._prefabGetter,spriteFrameGetter:this._lockSpriteFrameGetter,fieldModel:this._model,prefabName:"LockView"});this._pieceFactory=new u.PieceFactory({builderMap:(e={},e[a.PieceType.Ring]=new f.RingPieceBuilder({prefabGetter:this._prefabGetter,spriteFrameGetter:this._ringSpriteFrameGetter,fieldModel:this._model,blockerBuilder:t,prefabName:"Ring"}),e[a.PieceType.LockablePiece]=new d.LockablePieceBuilder({prefabGetter:this._prefabGetter,fieldModel:this._model,blockerBuilder:t,prefabName:"Lock"}),e)})}},t.prototype._buildField=function(){return c(this,void 0,void 0,function(){var e,t,o,r,n,i;return l(this,function(c){switch(c.label){case 0:if(this._configureBuilder(),this.node.children.forEach(function(e){return e.destroy()}),e=new cc.PrivateNode("Field"),this.node.addChild(e),!Array.isArray(this._pieces))return[3,4];t=0,o=this._pieces,c.label=1;case 1:return t<o.length?(r=o[t],n=r.getData(),[4,this._pieceFactory.createPiece(n.type,{configEntry:n})]):[3,4];case 2:i=c.sent().node,this._fieldData.push(n),e.addChild(i),c.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},i([P],t.prototype,"_pieces",void 0),i([P],t.prototype,"_fieldData",void 0),i([P({type:_.PrefabGetterComponent,visible:!0})],t.prototype,"_prefabGetter",void 0),i([P({type:y.SpriteFrameGetterComponent,visible:!0})],t.prototype,"_ringSpriteFrameGetter",void 0),i([P({type:y.SpriteFrameGetterComponent,visible:!0})],t.prototype,"_lockSpriteFrameGetter",void 0),i([P({type:[s.FieldPiece],visible:!0})],t.prototype,"pieces",null),i([P],t.prototype,"exportName",void 0),i([P({visible:!0})],t.prototype,"exportField",null),i([g],t)}(cc.Component);o.FieldBuilderComponent=m,cc._RF.pop()},{"../scripts/builder/BlockerPieceBuilder":"BlockerPieceBuilder","../scripts/builder/LockablePieceBuilder":"LockablePieceBuilder","../scripts/builder/RingPieceBuilder":"RingPieceBuilder","../scripts/enum/PieceType":"PieceType","../scripts/factory/PieceFactory":"PieceFactory","../scripts/model/FieldModel":"FieldModel","./DataExporter":"DataExporter","./FieldPiece":"FieldPiece","./PrefabGetterComponent":"PrefabGetterComponent","./SpriteFrameGetterComponent":"SpriteFrameGetterComponent"}],FieldInputHandler:[function(e,t,o){"use strict";cc._RF.push(t,"d8bdfM3fsNNv40w6iF6Ijf+","FieldInputHandler");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.FieldInputHandler=void 0;var c=e("../view/RingView"),l=cc._decorator.ccclass,a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onEnable=function(){this._listenEvents(!0)},t.prototype.onDisable=function(){this._listenEvents(!1)},t.prototype._listenEvents=function(e){var t=e?"on":"off";this.node[t](cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node[t](cc.Node.EventType.TOUCH_END,this._clearTarget,this),this.node[t](cc.Node.EventType.TOUCH_CANCEL,this._clearTarget,this)},t.prototype._onTouchMove=function(e){if(this._touchTarget)this._touchTarget.handleTouchMove(e);else for(var t=0,o=this.getComponentsInChildren(c.RingView);t<o.length;t++){var r=o[t].handleTouchMove(e);if(r){this._touchTarget=r;break}}},t.prototype._clearTarget=function(){this._touchTarget=null},i([l],t)}(cc.Component);o.FieldInputHandler=a,cc._RF.pop()},{"../view/RingView":"RingView"}],FieldModel:[function(e,t,o){"use strict";cc._RF.push(t,"4e41dGXM/5MWJz7Dz4dnBmG","FieldModel");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.FieldModel=void 0;var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._pieces=new Map,t._viewsByType={},t._modelsByType={},t}return n(t,e),t.prototype.initData=function(e){this._pieces=e.pieces},t.prototype.getData=function(){return{pieces:this._pieces}},t.prototype.getPieceModel=function(e){return this._pieces.get(e)},t.prototype.addPiece=function(e,t){var o=t.getData();this._pieces.set(e,t),this._addByType(o.type,this._viewsByType,e),this._addByType(o.type,this._modelsByType,t),t.view=e},t.prototype.removePiece=function(e){var t=this.getPieceModel(e),o=t.getData();this._removeByType(o.type,this._viewsByType,e),this._removeByType(o.type,this._modelsByType,t),this._pieces.delete(e)},t.prototype.getViewsByType=function(e){var t=this._viewsByType[e];return t?Array.from(t):[]},t.prototype.getModelsByType=function(e){var t=this._modelsByType[e];return t?Array.from(t):[]},t.prototype._addByType=function(e,t,o){void 0===t[e]&&(t[e]=new Set),t[e].add(o)},t.prototype._removeByType=function(e,t,o){void 0!==t[e]&&t[e].delete(o)},t}(e("./BaseModel").BaseModel);o.FieldModel=i,cc._RF.pop()},{"./BaseModel":"BaseModel"}],FieldPiece:[function(e,t,o){"use strict";cc._RF.push(t,"c30a8NYdSxAjIBdRW5XYqWy","FieldPiece");var r=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.FieldPiece=void 0;var n=e("../scripts/enum/ColorType"),i=e("../scripts/enum/PieceType"),c=e("../scripts/utils/AngleUtil"),l=e("./EnumUtil"),a=e("./LockPiece"),s=cc._decorator,u=s.ccclass,p=s.property,f=function(){function e(){this.type=0,this.color=0,this.x=0,this.y=0,this.angle=0,this.locks=[]}return e.prototype.getData=function(){var e=this,t=this._countPos(),o={type:l.EnumUtil.getCCEnumElement(i.PieceType,this.type),x:t.x,y:t.y,angle:this.angle,locks:[],color:l.EnumUtil.getCCEnumElement(n.ColorType,this.color)};return l.EnumUtil.getCCEnumElement(i.PieceType,this.type)===i.PieceType.LockablePiece&&(this.locks=[],[0,180].forEach(function(t){var o=new a.LockPiece;o.angle=t,e.locks.push(o)})),this.locks.forEach(function(t){o.locks.push({radius:e._countLockRadius(),angle:t.angle,color:l.EnumUtil.getCCEnumElement(n.ColorType,e.color)})}),o},e.prototype._countPos=function(){switch(l.EnumUtil.getCCEnumElement(i.PieceType,this.type)){case i.PieceType.Ring:return cc.v2(462*(this.x+(this.y%2?.5:0)),400*-this.y);case i.PieceType.LockablePiece:var e=c.AngleUtil.degreeToRad(this.angle);return cc.v2(462*(this.x+(this.y%2?.5:0))-231*Math.cos(e),400*-this.y-231*Math.sin(e))}},e.prototype._countLockRadius=function(){return l.EnumUtil.getCCEnumElement(i.PieceType,this.type)===i.PieceType.Ring?231:0},r([p({type:l.EnumUtil.getCCEnum(i.PieceType,[i.PieceType.Lock]),visible:!0})],e.prototype,"type",void 0),r([p({type:l.EnumUtil.getCCEnum(n.ColorType),visible:!0})],e.prototype,"color",void 0),r([p()],e.prototype,"x",void 0),r([p()],e.prototype,"y",void 0),r([p()],e.prototype,"angle",void 0),r([p({type:[a.LockPiece],visible:function(){return l.EnumUtil.getCCEnumElement(i.PieceType,this.type)===i.PieceType.Ring}})],e.prototype,"locks",void 0),r([u("FieldPiece")],e)}();o.FieldPiece=f,cc._RF.pop()},{"../scripts/enum/ColorType":"ColorType","../scripts/enum/PieceType":"PieceType","../scripts/utils/AngleUtil":"AngleUtil","./EnumUtil":"EnumUtil","./LockPiece":"LockPiece"}],GameManager:[function(e,t,o){"use strict";cc._RF.push(t,"8ab9c0oht9FH652tILOGJcl","GameManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameManager=void 0;var a=e("../injector/Injector"),s=e("../view/TutorialView"),u=cc._decorator,p=u.ccclass,f=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._config=null,t._fieldHolder=null,t._tutorialView=null,t}return n(t,e),t.prototype.onLoad=function(){cc.macro.ENABLE_MULTI_TOUCH=!1,this._initGame()},t.prototype._initGame=function(){return c(this,void 0,void 0,function(){var e,t,o,r,n,i,c,a=this;return l(this,function(l){switch(l.label){case 0:if(!this._config||!this._fieldHolder)return[3,5];if(e=this._config.json,t=[],!Array.isArray(e))return[3,4];o=0,r=e,l.label=1;case 1:return o<r.length?(n=r[o],i={configEntry:n},[4,this._pieceFactory.createPiece(n.type,i)]):[3,4];case 2:c=l.sent().node,t.push(c),l.label=3;case 3:return o++,[3,1];case 4:t.forEach(function(e){a._fieldHolder.addChild(e)}),this._tutorialView&&(this._tutorialView.tutorialController=this._tutorialController),l.label=5;case 5:return[2]}})})},i([f({type:cc.JsonAsset,visible:!0})],t.prototype,"_config",void 0),i([f({type:cc.Node,visible:!0})],t.prototype,"_fieldHolder",void 0),i([f({type:s.TutorialView,visible:!0})],t.prototype,"_tutorialView",void 0),i([a.Injector("PieceFactory")],t.prototype,"_pieceFactory",void 0),i([a.Injector("TutorialController")],t.prototype,"_tutorialController",void 0),i([p],t)}(cc.Component);o.GameManager=d,cc._RF.pop()},{"../injector/Injector":"Injector","../view/TutorialView":"TutorialView"}],IAnimator:[function(e,t,o){"use strict";cc._RF.push(t,"d2d69aFfRZBaZYKjYZ9AWQ/","IAnimator"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IController:[function(e,t,o){"use strict";cc._RF.push(t,"e4b716Rt/lKVru/uawEu9qg","IController"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IGetter:[function(e,t,o){"use strict";cc._RF.push(t,"b7c78WSGGVAnIP2CJTW0YkM","IGetter"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IView:[function(e,t,o){"use strict";cc._RF.push(t,"c9602SyMhpBHaolaUKae3WF","IView"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],InjectorConfig:[function(e,t,o){"use strict";var r;cc._RF.push(t,"7e5c07S/iBLMZmMh+oGwAXO","InjectorConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../builder/LockablePieceBuilder"),i=e("../../builder/RingPieceBuilder"),c=e("../../enum/PieceType"),l=e("../../factory/PieceFactory"),a=e("../../getter/BundlePrefabGetter"),s=e("../../getter/ColorSpriteFrameGetter"),u=e("../../loader/BundleLoader"),p=e("./CommonInjectorConfig"),f=e("./ModelInjectorConfig");o.default={BundleLoader:new u.BundleLoader({cacheManager:p.default.CacheManager,bundleConfig:{images:{type:cc.SpriteFrame,files:["ring_blue","ring_green","ring_pink","ring_red","ring_yellow","single_blocker_blue","single_blocker_green","single_blocker_pink","single_blocker_red","single_blocker_yellow"]},prefabs:{type:cc.Prefab,files:["Lock","LockView","Ring"]}}}),PieceFactory:new l.PieceFactory({builderMap:(r={},r[c.PieceType.Ring]=new i.RingPieceBuilder({prefabGetter:new a.BundlePrefabGetter({bundleName:"prefabs",cacheManager:p.default.CacheManager}),spriteFrameGetter:new s.ColorSpriteFrameGetter({bundleName:"images",spriteNamePrefix:"ring_",cacheManager:p.default.CacheManager}),fieldModel:f.default.FieldModel,blockerBuilder:p.default.BlockerPieceBuilder,prefabName:"Ring",handlers:{touchHandler:p.default.RingController,releaseHandler:p.default.LockablePieceController}}),r[c.PieceType.LockablePiece]=new n.LockablePieceBuilder({prefabGetter:new a.BundlePrefabGetter({bundleName:"prefabs",cacheManager:p.default.CacheManager}),fieldModel:f.default.FieldModel,blockerBuilder:p.default.BlockerPieceBuilder,prefabName:"Lock",handlers:{releaseHandler:p.default.LockablePieceController}}),r)}),TutorialController:p.default.TutorialController,FieldModel:f.default.FieldModel},cc._RF.pop()},{"../../builder/LockablePieceBuilder":"LockablePieceBuilder","../../builder/RingPieceBuilder":"RingPieceBuilder","../../enum/PieceType":"PieceType","../../factory/PieceFactory":"PieceFactory","../../getter/BundlePrefabGetter":"BundlePrefabGetter","../../getter/ColorSpriteFrameGetter":"ColorSpriteFrameGetter","../../loader/BundleLoader":"BundleLoader","./CommonInjectorConfig":"CommonInjectorConfig","./ModelInjectorConfig":"ModelInjectorConfig"}],Injector:[function(e,t,o){"use strict";cc._RF.push(t,"5dc8fC7Oy9EXI5kcmztn5+U","Injector"),Object.defineProperty(o,"__esModule",{value:!0}),o.Injector=void 0;var r=e("./config/InjectorConfig");o.Injector=function(e){void 0===e&&(e=void 0);var t=Symbol();return function(o,n){return Object.defineProperty(o,n,{get:function(){if(void 0===this[t]){var o=r.default[e];return o?(this[t]=o,o):null}return this[t]}})}},cc._RF.pop()},{"./config/InjectorConfig":"InjectorConfig"}],LoadingManager:[function(e,t,o){"use strict";cc._RF.push(t,"fdc03EXyPpOcrtuva/BO8NJ","LoadingManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},c=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.LoadingManager=void 0;var a=e("../injector/Injector"),s=cc._decorator,u=s.ccclass,p=s.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._nextSceneName="Main",t._loadingLabel=null,t}return n(t,e),t.prototype.onLoad=function(){this._loadBundles()},t.prototype._loadBundles=function(){return c(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,this._bundleLoader.load(this._progressCallback.bind(this))];case 1:return e.sent(),cc.director.loadScene(this._nextSceneName),[2]}})})},t.prototype._progressCallback=function(e){this._loadingLabel&&(this._loadingLabel.string="Loading... "+Math.floor(100*e)+"%")},i([p({visible:!0})],t.prototype,"_nextSceneName",void 0),i([p({type:cc.Label,visible:!0})],t.prototype,"_loadingLabel",void 0),i([a.Injector("BundleLoader")],t.prototype,"_bundleLoader",void 0),i([u],t)}(cc.Component);o.LoadingManager=f,cc._RF.pop()},{"../injector/Injector":"Injector"}],LockCollisionHandler:[function(e,t,o){"use strict";cc._RF.push(t,"9f663S4acpI5KC5BMWVWlZ0","LockCollisionHandler");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.LockCollisionHandler=void 0;var c,l=e("../../view/LockablePieceView"),a=e("../../view/LockView"),s=e("./BaseCollisionHandler"),u=cc._decorator,p=u.ccclass,f=u.property;(function(e){e[e.Body=0]="Body",e[e.Hole=1]="Hole"})(c||(c={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lockView=null,t._collisions=new Set,t}return n(t,e),t.prototype._addCollision=function(e){e.tag!==c.Hole&&(this._collisions.add(e),this._processCollisions())},t.prototype._stayCollision=function(e,t){if(e.tag===c.Hole){var o=this._checkEntering(e,t);o&&!this._collisions.has(e)&&(this._collisions.add(e),this._processCollisions()),!o&&this._collisions.has(e)&&(this._collisions.delete(e),this._processCollisions())}},t.prototype._removeCollision=function(e){this._collisions.delete(e),this._processCollisions()},t.prototype._processCollisions=function(){if(this._lockView){var e=Array.from(this._collisions);if(!e.some(function(e){return e.tag===c.Hole})&&e.length){var t=e[0],o=t.getComponent(l.LockablePieceView)||t.node.parent.getComponent(l.LockablePieceView);if(o)return void this._lockView.addLockedView(o)}this._lockView.deleteLockedView()}},t.prototype._checkEntering=function(e,t){if(t instanceof cc.CircleCollider&&e instanceof cc.CircleCollider){var o=t.world.aabb,r=e.world.aabb;return o.x>=r.x&&o.x+o.width<=r.x+r.width&&o.y>=r.y&&o.y+o.height<=r.y+r.height}return!1},i([f({type:a.LockView,visible:!0})],t.prototype,"_lockView",void 0),i([p],t)}(s.BaseCollisionHandler);o.LockCollisionHandler=d,cc._RF.pop()},{"../../view/LockView":"LockView","../../view/LockablePieceView":"LockablePieceView","./BaseCollisionHandler":"BaseCollisionHandler"}],LockController:[function(e,t,o){"use strict";cc._RF.push(t,"d1630a2BfhH1bfrAdtfKsDL","LockController"),Object.defineProperty(o,"__esModule",{value:!0}),o.LockController=void 0;var r=e("../model/LockModel"),n=function(){function e(e){var t=e.fieldModel,o=e.lockablePieceController;this._fieldModel=t,this._lockablePieceController=o}return e.prototype.handle=function(e){if(this._fieldModel.getPieceModel(e)instanceof r.LockModel){var t=e.lockedView,o=this._fieldModel.getPieceModel(e),n=t?this._fieldModel.getPieceModel(t):null,i=o.getData().ownerModel;o.updateData({lockedTarget:n}),i&&(null==i||i.updateLockedState(),this._lockablePieceController.handle(i.view))}},e}();o.LockController=n,cc._RF.pop()},{"../model/LockModel":"LockModel"}],LockModel:[function(e,t,o){"use strict";cc._RF.push(t,"ef2662sCrhCJIDF0WI2hxw5","LockModel");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.LockModel=void 0;var i=e("../enum/PieceType"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.initData=function(t){e.prototype.initData.call(this,t),this._type=i.PieceType.Lock,this._lockedTarget=t.lockedTarget,this._radius=t.radius},t.prototype.getData=function(){return Object.assign(e.prototype.getData.call(this),{ownerModel:this._ownerModel,lockedTarget:this._lockedTarget,radius:this._radius,isLocked:!!this._lockedTarget})},t.prototype.setOwnerModel=function(e){this._ownerModel=e},t.prototype.serialize=function(){return{radius:this._radius,angle:this._angle,color:this._color}},t}(e("./RenderModel").RenderModel);o.LockModel=c,cc._RF.pop()},{"../enum/PieceType":"PieceType","./RenderModel":"RenderModel"}],LockPiece:[function(e,t,o){"use strict";cc._RF.push(t,"6722eO9Di9NqZSCuricQlc9","LockPiece");var r=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.LockPiece=void 0;var n=cc._decorator,i=n.ccclass,c=n.property,l=function(){function e(){this.angle=0}return r([c()],e.prototype,"angle",void 0),r([i("LockPiece")],e)}();o.LockPiece=l,cc._RF.pop()},{}],LockView:[function(e,t,o){"use strict";cc._RF.push(t,"fe4aeYhGXZLFLwLs7agAZN0","LockView");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.LockView=void 0;var c=e("./BaseView"),l=e("../components/RotationLimiterComponent"),a=cc._decorator,s=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._collider=null,t._rotationLimiter=null,t._lockedView=null,t._collisionHandler=null,t}return n(t,e),Object.defineProperty(t.prototype,"rotationLimiter",{get:function(){return this._rotationLimiter},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colliderWorldPos",{get:function(){var e;return this._collider?this._collider.node.convertToWorldSpaceAR(null===(e=this._collider)||void 0===e?void 0:e.offset):this.node.convertToWorldSpaceAR(cc.Vec2.ZERO)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){var e,t;return null!==(t=null===(e=this._collider)||void 0===e?void 0:e.node.x)&&void 0!==t?t:0},set:function(e){this._collider&&(this._collider.node.x=e,this._setFillRange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lockedView",{get:function(){return this._lockedView},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"collisionHandler",{set:function(e){this._collisionHandler=e},enumerable:!1,configurable:!0}),t.prototype.render=function(e){this.angle=e.angle,this.radius=e.radius},t.prototype.addLockedView=function(e){var t;this._lockedView=e,null===(t=this._collisionHandler)||void 0===t||t.handle(this)},t.prototype.deleteLockedView=function(){var e,t=this._lockedView;this._lockedView=null,null===(e=this._collisionHandler)||void 0===e||e.handle(this),null==t||t.release()},t.prototype.destroyView=function(){this._collider.enabled=!1},t.prototype.onLoad=function(){this._setFillRange()},t.prototype._setFillRange=function(){if(this._renderSprite){var e=this._renderSprite.node,t=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),o=e.convertToNodeSpaceAR(t).x/e.width+e.anchorX;this._renderSprite.type=cc.Sprite.Type.FILLED,this._renderSprite.fillType=cc.Sprite.FillType.HORIZONTAL,this._renderSprite.fillStart=0,this._renderSprite.fillRange=Math.min(1,Math.max(0,o))}},i([u({type:cc.CircleCollider,visible:!0})],t.prototype,"_collider",void 0),i([u({type:l.RotationLimiterComponent,visible:!0})],t.prototype,"_rotationLimiter",void 0),i([u({visible:function(){return this._collider}})],t.prototype,"radius",null),i([s],t)}(c.BaseView);o.LockView=p,cc._RF.pop()},{"../components/RotationLimiterComponent":"RotationLimiterComponent","./BaseView":"BaseView"}],LockablePieceBuilder:[function(e,t,o){"use strict";cc._RF.push(t,"6aa7fzU0MZP/rLh3+f+pzrW","LockablePieceBuilder");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},l=this&&this.__rest||function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(o[r[n]]=e[r[n]])}return o};Object.defineProperty(o,"__esModule",{value:!0}),o.LockablePieceBuilder=void 0;var a=e("../model/LockablePieceModel"),s=e("../view/LockablePieceView"),u=function(e){function t(t){var o=t.blockerBuilder,r=l(t,["blockerBuilder"]),n=e.call(this,r)||this;return n._blockerBuilder=o,n}return n(t,e),t.prototype._getPieceData=function(e,t){return i(this,void 0,Promise,function(){var o,r,n,i;return c(this,function(c){switch(c.label){case 0:return o=this._getView(e),[4,this._configureLocks(t.configEntry,e,o)];case 1:return r=c.sent(),n=Object.assign({},t.configEntry,{locks:r}),i=this._getModel(n),this._fieldModel.addPiece(o,i),r.forEach(function(e){e.setOwnerModel(i)}),[4,this._updateSpriteFrame(o,t.configEntry.color)];case 2:return c.sent(),this._bindHandlers(o),[2,{node:e,view:o,model:i}]}})})},t.prototype._getView=function(e){return null==e?void 0:e.getComponent(s.LockablePieceView)},t.prototype._getModel=function(e){return new a.LockablePieceModel(e)},t.prototype._configureLocks=function(e,t,o){return i(this,void 0,Promise,function(){var r,n,i,l,a;return c(this,function(c){switch(c.label){case 0:if(r=[],!e)return[3,4];n=0,i=e.locks,c.label=1;case 1:return n<i.length?(l=i[n],[4,this._blockerBuilder.build({configEntry:l})]):[3,4];case 2:a=c.sent(),o.addLockView(a.view),t.addChild(a.node),r.push(a.model),c.label=3;case 3:return n++,[3,1];case 4:return[2,r]}})})},t}(e("./PieceBuilder").PieceBuilder);o.LockablePieceBuilder=u,cc._RF.pop()},{"../model/LockablePieceModel":"LockablePieceModel","../view/LockablePieceView":"LockablePieceView","./PieceBuilder":"PieceBuilder"}],LockablePieceController:[function(e,t,o){"use strict";cc._RF.push(t,"ccadetB8l5Fa4SJWTypvrOS","LockablePieceController"),Object.defineProperty(o,"__esModule",{value:!0}),o.LockablePieceController=void 0;var r=e("../enum/PieceType"),n=e("../model/LockablePieceModel"),i=function(){function e(e){var t=e.fieldModel;this._fieldModel=t}return e.prototype.handle=function(e){var t=this,o=this._fieldModel.getPieceModel(e);if(o instanceof n.LockablePieceModel){var i=o.getData(),c=this._fieldModel.getModelsByType(r.PieceType.Lock).some(function(e){return e.getData().lockedTarget===o}),l=i.locks.some(function(e){return e.getData().isLocked});c||l||(e.locks.forEach(function(e){t._fieldModel.removePiece(e)}),this._fieldModel.removePiece(e),e.destroyView())}},e}();o.LockablePieceController=i,cc._RF.pop()},{"../enum/PieceType":"PieceType","../model/LockablePieceModel":"LockablePieceModel"}],LockablePieceModel:[function(e,t,o){"use strict";cc._RF.push(t,"90460zebwVGjqqT3eVpOF7C","LockablePieceModel");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],c=0,l=i.length;c<l;c++,n++)r[n]=i[c];return r};Object.defineProperty(o,"__esModule",{value:!0}),o.LockablePieceModel=void 0;var c=e("../enum/PieceType"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.initData=function(t){var o;e.prototype.initData.call(this,t),this._type=c.PieceType.LockablePiece,this._locks=null!==(o=t.locks)&&void 0!==o?o:[]},t.prototype.getData=function(){return Object.assign(e.prototype.getData.call(this),{locks:this._locks,isLocked:this._isLocked})},t.prototype.updateLockedState=function(){var e=i(this._locks);this._isLocked=e.some(function(e){return e.getData().isLocked})},t.prototype.serialize=function(){return Object.assign({locks:this._locks.map(function(e){return e.serialize()})},e.prototype.serialize.call(this))},t}(e("./RenderModel").RenderModel);o.LockablePieceModel=l,cc._RF.pop()},{"../enum/PieceType":"PieceType","./RenderModel":"RenderModel"}],LockablePieceView:[function(e,t,o){"use strict";cc._RF.push(t,"d69b84zuldCdZHLzTHuTabs","LockablePieceView");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.LockablePieceView=void 0;var c=e("./BaseView"),l=e("../components/animator/DestroyAnimator"),a=cc._decorator,s=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._destroyAnimator=null,t._releaseHandler=null,t._locks=new Set,t}return n(t,e),Object.defineProperty(t.prototype,"releaseHandler",{set:function(e){this._releaseHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"locks",{get:function(){return Array.from(this._locks)},enumerable:!1,configurable:!0}),t.prototype.addLockView=function(e){this._locks.add(e)},t.prototype.destroyView=function(){var e;this._locks.forEach(function(e){return e.destroyView()}),null===(e=this._destroyAnimator)||void 0===e||e.animate()},t.prototype.release=function(){var e;null===(e=this._releaseHandler)||void 0===e||e.handle(this)},i([u({type:l.DestroyAnimator,visible:!0})],t.prototype,"_destroyAnimator",void 0),i([s],t)}(c.BaseView);o.LockablePieceView=p,cc._RF.pop()},{"../components/animator/DestroyAnimator":"DestroyAnimator","./BaseView":"BaseView"}],ModelInjectorConfig:[function(e,t,o){"use strict";cc._RF.push(t,"308eds6W0JLu7yoEU27xEFP","ModelInjectorConfig"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../model/FieldModel");o.default={FieldModel:new r.FieldModel},cc._RF.pop()},{"../../model/FieldModel":"FieldModel"}],PhysicsManager:[function(e,t,o){"use strict";cc._RF.push(t,"292b3If2uBATpiL2VKDJJLY","PhysicsManager");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,a=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._enablePhysics2D=!1,t._enableAccumulator=!1,t._gravity2D=cc.v2(0,-980),t._debugPhysics2D=!1,t._enablePhysics3D=!1,t._gravity3D=cc.v3(0,-10,0),t._enableCollision=!1,t._debugCollision=!1,t._physics2DManager=null,t._physics3DManager=null,t._collisionManager=null,t}return n(t,e),t.prototype.onLoad=function(){this._enablePhysics2D&&(this._physics2DManager=cc.director.getPhysicsManager(),this._physics2DManager&&(this._physics2DManager.enabled=!0,this._physics2DManager.gravity=this._gravity2D,this._physics2DManager.enabledAccumulator=this._enableAccumulator,this._debugPhysics2D&&(this._physics2DManager.debugDrawFlags=cc.PhysicsManager.DrawBits.e_aabbBit|cc.PhysicsManager.DrawBits.e_jointBit|cc.PhysicsManager.DrawBits.e_shapeBit))),this._enablePhysics3D&&(this._physics3DManager=cc.director.getPhysics3DManager(),this._physics3DManager&&(this._physics3DManager.enabled=!0,this._physics3DManager.gravity=this._gravity3D)),this._enableCollision&&(this._collisionManager=cc.director.getCollisionManager(),this._collisionManager&&(this._collisionManager.enabled=!0,this._collisionManager.enabledDrawBoundingBox=this._debugCollision,this._collisionManager.enabledDebugDraw=this._debugCollision))},i([a({visible:!0})],t.prototype,"_enablePhysics2D",void 0),i([a({visible:function(){return this._enablePhysics2D}})],t.prototype,"_enableAccumulator",void 0),i([a({visible:function(){return this._enablePhysics2D}})],t.prototype,"_gravity2D",void 0),i([a({visible:function(){return this._enablePhysics2D}})],t.prototype,"_debugPhysics2D",void 0),i([a({visible:!0})],t.prototype,"_enablePhysics3D",void 0),i([a({visible:function(){return this._enablePhysics3D}})],t.prototype,"_gravity3D",void 0),i([a({visible:!0})],t.prototype,"_enableCollision",void 0),i([a({visible:function(){return this._enableCollision}})],t.prototype,"_debugCollision",void 0),i([l],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],PieceBuilder:[function(e,t,o){"use strict";cc._RF.push(t,"6f5c7Reh7NFsq0wjaO8/yOO","PieceBuilder");var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.PieceBuilder=void 0;var i=function(){function e(e){var t=e.prefabGetter,o=e.spriteFrameGetter,r=e.fieldModel,n=e.prefabName,i=e.handlers;this._prefabGetter=t,this._spriteFrameGetter=o,this._fieldModel=r,this._prefabName=n,this._handlers=null!=i?i:{}}return e.prototype.build=function(e){var t;return r(this,void 0,Promise,function(){var o,r,i;return n(this,function(n){switch(n.label){case 0:return[4,this._prefabGetter.get(this._prefabName)];case 1:return(o=n.sent())?(r=cc.instantiate(o),[4,this._getPieceData(r,e)]):[3,3];case 2:return i=n.sent(),null===(t=i.view)||void 0===t||t.render(i.model.getData()),[2,i];case 3:return[2]}})})},e.prototype._updateSpriteFrame=function(e,t){return r(this,void 0,void 0,function(){var o;return n(this,function(r){switch(r.label){case 0:return e&&this._spriteFrameGetter?[4,this._spriteFrameGetter.get(t)]:[3,2];case 1:o=r.sent(),e.changeSpriteFrame(o),r.label=2;case 2:return[2]}})})},e.prototype._bindHandlers=function(e){Object.entries(this._handlers).forEach(function(t){var o=t[0],r=t[1];e[o]=r})},e}();o.PieceBuilder=i,cc._RF.pop()},{}],PieceColorMap:[function(e,t,o){"use strict";cc._RF.push(t,"0fceepVSBxJBaFsdOWq+CVh","PieceColorMap");var r=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.PieceColorMap=void 0;var n=e("../scripts/enum/ColorType"),i=e("./EnumUtil"),c=cc._decorator,l=c.ccclass,a=c.property,s=function(){function e(){this.colorType=0,this.spriteFrame=null}return r([a({type:i.EnumUtil.getCCEnum(n.ColorType)})],e.prototype,"colorType",void 0),r([a({type:cc.SpriteFrame})],e.prototype,"spriteFrame",void 0),r([l("PieceColorMap")],e)}();o.PieceColorMap=s,cc._RF.pop()},{"../scripts/enum/ColorType":"ColorType","./EnumUtil":"EnumUtil"}],PieceFactory:[function(e,t,o){"use strict";cc._RF.push(t,"98441yD+fZH+7Ju3qC1B6+R","PieceFactory");var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function c(e){try{a(r.next(e))}catch(t){i(t)}}function l(e){try{a(r.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,l)}a((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var o,r,n,i,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return a([e,t])}}function a(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(l){i=[6,l],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.PieceFactory=void 0;var i=function(){function e(e){var t=e.builderMap;this._builderMap=t}return e.prototype.createPiece=function(e,t){return r(this,void 0,Promise,function(){var o;return n(this,function(r){switch(r.label){case 0:return(o=this._builderMap[e])?[4,o.build(t)]:[3,2];case 1:return[2,r.sent()];case 2:return[2,null]}})})},e}();o.PieceFactory=i,cc._RF.pop()},{}],PiecePrefabMap:[function(e,t,o){"use strict";cc._RF.push(t,"2c860l/P15I+oGIU07QCQCK","PiecePrefabMap");var r=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.PiecePrefabMap=void 0;var n=e("../scripts/enum/PieceType"),i=e("./EnumUtil"),c=cc._decorator,l=c.ccclass,a=c.property,s=function(){function e(){this.pieceType=0,this.prefab=null}return r([a({type:i.EnumUtil.getCCEnum(n.PieceType)})],e.prototype,"pieceType",void 0),r([a({type:cc.Prefab})],e.prototype,"prefab",void 0),r([l("PiecePrefabMap")],e)}();o.PiecePrefabMap=s,cc._RF.pop()},{"../scripts/enum/PieceType":"PieceType","./EnumUtil":"EnumUtil"}],PieceType:[function(e,t,o){"use strict";cc._RF.push(t,"843e6Uw3kpBZJ5ehC6ITgMX","PieceType"),Object.defineProperty(o,"__esModule",{value:!0}),o.PieceType=void 0,function(e){e.Ring="ring",e.LockablePiece="lockablePiece",e.Lock="lock"}(o.PieceType||(o.PieceType={})),cc._RF.pop()},{}],PrefabGetterComponent:[function(e,t,o){"use strict";cc._RF.push(t,"464f1sKNNhIXLoK+BJdLruM","PrefabGetterComponent");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.PrefabGetterComponent=void 0;var c=cc._decorator,l=c.ccclass,a=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._prefabs=[],t}return n(t,e),t.prototype.get=function(e){return this._prefabs.find(function(t){return t.name===e})},i([a({type:[cc.Prefab],visible:!0})],t.prototype,"_prefabs",void 0),i([l],t)}(cc.Component);o.PrefabGetterComponent=s,cc._RF.pop()},{}],RenderModel:[function(e,t,o){"use strict";cc._RF.push(t,"121563lCzFEGpZL3D5VOwiY","RenderModel");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.RenderModel=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"view",{get:function(){return this._view},set:function(e){this._view=e},enumerable:!1,configurable:!0}),t.prototype.initData=function(e){var t,o,r;this._x=null!==(t=e.x)&&void 0!==t?t:0,this._y=null!==(o=e.y)&&void 0!==o?o:0,this._angle=null!==(r=e.angle)&&void 0!==r?r:0,this._color=e.color},t.prototype.updateData=function(t){e.prototype.updateData.call(this,t),this._renderView()},t.prototype.getData=function(){return{type:this._type,x:this._x,y:this._y,angle:this._angle}},t.prototype._renderView=function(){var e;null===(e=this.view)||void 0===e||e.render(this.getData())},t.prototype.serialize=function(){return{type:this._type,x:this._x,y:this._y,angle:this._angle,color:this._color}},t}(e("./BaseModel").BaseModel);o.RenderModel=i,cc._RF.pop()},{"./BaseModel":"BaseModel"}],RingController:[function(e,t,o){"use strict";cc._RF.push(t,"04c1180hUhCPoBEPmqYxc1o","RingController"),Object.defineProperty(o,"__esModule",{value:!0}),o.RingController=void 0;var r=e("../model/RingModel"),n=e("../utils/AngleUtil"),i=function(){function e(e){var t=e.fieldModel,o=e.tutorialController;this._fieldModel=t,this._tutorialController=o}return e.prototype.handle=function(e,t){var o,n=this._fieldModel.getPieceModel(e);n instanceof r.RingModel&&(this._handleRotation(e,t,n),n.updateLockedState(),null===(o=this._tutorialController)||void 0===o||o.handle())},e.prototype._handleRotation=function(e,t,o){var r=this,i=o.getData();if(i.isRotatable){var c=cc.Camera.findCamera(e.node),l=e.node.convertToWorldSpaceAR(cc.Vec2.ZERO),a=cc.v2(c.getWorldToScreenPoint(l)),s=t.touch.getPreviousLocation(),u=t.touch.getLocation(),p=i.angle,f=n.AngleUtil.getDeltaAngle(a,s,u);if(e.locks.some(function(e){return r._checkRotationBlocked(e,f)}))return;o.updateData({angle:n.AngleUtil.validateAngle(p-f)})}else e.animateBlock()},e.prototype._checkRotationBlocked=function(e,t){return t<0?e.rotationLimiter.overClockwiseBlocked:e.rotationLimiter.clockwiseBlocked},e}();o.RingController=i,cc._RF.pop()},{"../model/RingModel":"RingModel","../utils/AngleUtil":"AngleUtil"}],RingModel:[function(e,t,o){"use strict";cc._RF.push(t,"24c3eUvHrJLooVeIr7Cm6hg","RingModel");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.RingModel=void 0;var i=e("../enum/PieceType"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.initData=function(t){e.prototype.initData.call(this,t),this._type=i.PieceType.Ring},t.prototype.getData=function(){return Object.assign({isRotatable:this._checkRotateAbility()},e.prototype.getData.call(this))},t.prototype._checkRotateAbility=function(){return this._locks.every(function(e){return!e.getData().isLocked})},t}(e("./LockablePieceModel").LockablePieceModel);o.RingModel=c,cc._RF.pop()},{"../enum/PieceType":"PieceType","./LockablePieceModel":"LockablePieceModel"}],RingPieceBuilder:[function(e,t,o){"use strict";cc._RF.push(t,"c4a082+ipxEuphYQEe+SjkU","RingPieceBuilder");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.RingPieceBuilder=void 0;var i=e("../model/RingModel"),c=e("../view/RingView"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._getView=function(e){return null==e?void 0:e.getComponent(c.RingView)},t.prototype._getModel=function(e){return new i.RingModel(e)},t}(e("./LockablePieceBuilder").LockablePieceBuilder);o.RingPieceBuilder=l,cc._RF.pop()},{"../model/RingModel":"RingModel","../view/RingView":"RingView","./LockablePieceBuilder":"LockablePieceBuilder"}],RingView:[function(e,t,o){"use strict";cc._RF.push(t,"d2d3dHPtbpK8ZdatvQnUneY","RingView");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.RingView=void 0;var c=e("../components/animator/BlockAnimator"),l=e("./LockablePieceView"),a=cc._decorator,s=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._collider=null,t._blockAnimator=null,t._touchHandler=null,t}return n(t,e),Object.defineProperty(t.prototype,"touchHandler",{set:function(e){this._touchHandler=e},enumerable:!1,configurable:!0}),t.prototype._onTouchMove=function(e){var t;null===(t=this._touchHandler)||void 0===t||t.handle(this,e)},t.prototype.animateBlock=function(){this._blockAnimator.animate()},t.prototype.destroyView=function(){this._collider.enabled=!1,e.prototype.destroyView.call(this)},t.prototype.handleTouchMove=function(e){var t=cc.Camera.findCamera(this.node),o=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),r=e.touch.getLocation(),n=cc.v2(t.getScreenToWorldPoint(r));return Math.hypot(o.x-n.x,o.y-n.y)<this.node.width/2?(this._onTouchMove(e),this):null},i([u({type:cc.Collider,visible:!0})],t.prototype,"_collider",void 0),i([u({type:c.BlockAnimator,visible:!0})],t.prototype,"_blockAnimator",void 0),i([s],t)}(l.LockablePieceView);o.RingView=p,cc._RF.pop()},{"../components/animator/BlockAnimator":"BlockAnimator","./LockablePieceView":"LockablePieceView"}],RotationLimiterComponent:[function(e,t,o){"use strict";cc._RF.push(t,"d3941R28tFH3L3bw2FiABaV","RotationLimiterComponent");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.RotationLimiterComponent=void 0;var c=cc._decorator,l=c.ccclass,a=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._clockwiseCollider=null,t._overClockwiseCollider=null,t._clockwiseCollisions=new Set,t._overClockwiseCollisions=new Set,t}return n(t,e),Object.defineProperty(t.prototype,"clockwiseBlocked",{get:function(){return this._clockwiseCollisions.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"overClockwiseBlocked",{get:function(){return this._overClockwiseCollisions.size>0},enumerable:!1,configurable:!0}),t.prototype.onCollisionEnter=function(e,t){switch(t){case this._overClockwiseCollider:this._overClockwiseCollisions.add(e);break;case this._clockwiseCollider:this._clockwiseCollisions.add(e)}},t.prototype.onCollisionExit=function(e,t){switch(t){case this._overClockwiseCollider:this._overClockwiseCollisions.delete(e);break;case this._clockwiseCollider:this._clockwiseCollisions.delete(e)}},i([a({type:cc.Collider,visible:!0})],t.prototype,"_clockwiseCollider",void 0),i([a({type:cc.Collider,visible:!0})],t.prototype,"_overClockwiseCollider",void 0),i([l],t)}(cc.Component);o.RotationLimiterComponent=s,cc._RF.pop()},{}],SpriteFrameGetterComponent:[function(e,t,o){"use strict";cc._RF.push(t,"98fdeqgJ7tBLaMED0HET6ma","SpriteFrameGetterComponent");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.SpriteFrameGetterComponent=void 0;var c=e("../scripts/enum/ColorType"),l=e("./EnumUtil"),a=e("./PieceColorMap"),s=cc._decorator,u=s.ccclass,p=s.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._spriteFrameConfig=[],t}return n(t,e),t.prototype.get=function(e){var t;return null===(t=this._spriteFrameConfig.find(function(t){return t.colorType===l.EnumUtil.getCCEnumIndex(c.ColorType,e)}))||void 0===t?void 0:t.spriteFrame},i([p({type:[a.PieceColorMap],visible:!0})],t.prototype,"_spriteFrameConfig",void 0),i([u],t)}(cc.Component);o.SpriteFrameGetterComponent=f,cc._RF.pop()},{"../scripts/enum/ColorType":"ColorType","./EnumUtil":"EnumUtil","./PieceColorMap":"PieceColorMap"}],TutorialController:[function(e,t,o){"use strict";cc._RF.push(t,"cb64dGivUZAP4xNLDYCzvIt","TutorialController"),Object.defineProperty(o,"__esModule",{value:!0}),o.TutorialController=void 0;var r=e("../enum/PieceType"),n=e("../view/TutorialView"),i=function(){function e(e){var t=e.tutorNodePath,o=e.fieldModel;this._tutorNodePath=t,this._fieldModel=o}return e.prototype.handle=function(e,t){void 0===t&&(t=!1);var o=null!=e?e:this._getTutorialView();if(o){var n=this._fieldModel.getModelsByType(r.PieceType.Ring).find(function(e){return e.getData().isRotatable});if(null==n?void 0:n.view){var i=n.view;o.target=i.node,t?o.playTutorial():o.setSlippingMode()}else o.target=null}},e.prototype._getTutorialView=function(){var e=cc.find(this._tutorNodePath);return null==e?void 0:e.getComponent(n.TutorialView)},e}();o.TutorialController=i,cc._RF.pop()},{"../enum/PieceType":"PieceType","../view/TutorialView":"TutorialView"}],TutorialView:[function(e,t,o){"use strict";cc._RF.push(t,"7e10eXFSvRM3orMX+J9T8wa","TutorialView");var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.TutorialView=void 0;var c=cc._decorator,l=c.ccclass,a=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._spine=null,t._spineAnimationName="swipe",t._animation=null,t._tutorialTimeout=3,t._sleepTimer=0,t._tutorialController=null,t._target=null,t}return n(t,e),Object.defineProperty(t.prototype,"tutorialController",{set:function(e){this._tutorialController=e,this._tutorialController.handle(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{set:function(e){this._target=e},enumerable:!1,configurable:!0}),t.prototype.update=function(e){this._sleepTimer<this._tutorialTimeout&&this._sleepTimer+e>=this._tutorialTimeout&&this.playTutorial(),this._sleepTimer+=e},t.prototype.playTutorial=function(){var e,t,o,r;if(!1===(null===(e=this._target)||void 0===e?void 0:e.isValid)&&(null===(t=this._tutorialController)||void 0===t||t.handle(this,!0)),this._target){var n=this._target.convertToWorldSpaceAR(cc.Vec2.ZERO),i=this.node.parent.convertToNodeSpaceAR(n);this.node.setPosition(i),null===(o=this._animation)||void 0===o||o.play(),null===(r=this._spine)||void 0===r||r.setAnimation(0,this._spineAnimationName,!0),this.node.opacity=255}},t.prototype.setSlippingMode=function(){var e=this;cc.tween(this.node).to(.25,{opacity:0}).call(function(){e._sleepTimer=0}).start()},i([a({type:sp.Skeleton,visible:!0})],t.prototype,"_spine",void 0),i([a({visible:function(){return this._spine}})],t.prototype,"_spineAnimationName",void 0),i([a({type:cc.Animation,visible:!0})],t.prototype,"_animation",void 0),i([a({visible:!0})],t.prototype,"_tutorialTimeout",void 0),i([l],t)}(cc.Component);o.TutorialView=s,cc._RF.pop()},{}]},{},["DataExporter","EnumUtil","FieldBuilderComponent","FieldPiece","LockPiece","PieceColorMap","PiecePrefabMap","PrefabGetterComponent","SpriteFrameGetterComponent","PhysicsManager","BlockerPieceBuilder","LockablePieceBuilder","PieceBuilder","RingPieceBuilder","CameraAdapter","FieldInputHandler","RotationLimiterComponent","BaseAnimator","BlockAnimator","DestroyAnimator","BaseCollisionHandler","LockCollisionHandler","LockController","LockablePieceController","RingController","TutorialController","ColorType","PieceType","PieceFactory","BundlePrefabGetter","ColorSpriteFrameGetter","Injector","CommonInjectorConfig","InjectorConfig","ModelInjectorConfig","IAnimator","IController","IGetter","IView","BundleLoader","CacheManager","GameManager","LoadingManager","BaseModel","FieldModel","LockModel","LockablePieceModel","RenderModel","RingModel","Config","AngleUtil","BaseView","LockView","LockablePieceView","RingView","TutorialView"]);